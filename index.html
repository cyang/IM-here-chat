<!doctype html>
<html>
	<head>
		<title>Socket.io chat</title>

		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font: 13px Helvetic, Arial;
			}

			form#message {
				display: none;
				background: black;
				padding: 3px;
				position: fixed;
				bottom: 0;
				width: 100%;
			}

			form#message input {
				border: 0;
				padding: 10px;
				width: 90%;
				margin-right: .5%;
			}

			form#message button {
				width: 9%;
				background: rgb(130, 224, 255);
				border: none;
				padding: 10px;
			}

			form#user {
				background: black;
				padding: 3px;
				position: fixed;
				top: 100px;
				width: 100%;
			}

			form#user input {
				border: 0;
				padding: 10px;
				width: 90%;
				margin-right: .5%;
			}

			form#user button {
				width: 9%;
				background: rgb(130, 224, 255);
				border: none;
				padding: 10px;
			}



			#messages {
				list-style-type: none;
				margin: 0;
				padding: 0;
				top: 40px;
			}

			#messages li{
				padding: 5px 10px;
			}

			#messages li:nth-child(odd) {
				background: #eee;
			}
		</style>
	</head>
	<body>
		<ul id="messages"></ul>

		<form id="user" action="">
			<input id="user" autocomplete="off" />
			<button>Enter</button>
			</input>
		</form>

		<form id="message" action="">
			<input id="message" autocomplete="off" />
			<button>Send</button>
			</input>
		</form>
		<script src="/socket.io/socket.io.js"></script>
		<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
		<script>
			var socket = io();

			socket.on('A user has disconnected', function(){
				$('#messages').append($('<li>').text("A user has disconnected"));
			});

			// Send message to server
			$('form#message').submit(function(){
				socket.emit('chat message', $('input#message').val());
				$('input#message').val('');
				return false;
			});
			// Retrieve message from server and display
			socket.on('chat message', function(msg){
    			$('#messages').append($('<li>').text(msg));
  			});

			// Send username to server
			$('form#user').submit(function(){
				socket.emit('user connected', $('input#user').val());
				$('input#user').val('');
				$(this).hide();
				$(this).next().show();
				return false;
			});
			// Retrieve username from server and display
			socket.on('user connected', function(msg, messagesArray){
				for (var i = 0; i < messagesArray.length; i++) {
					$('#messages').append($('<li>').text(messagesArray[i]));
				}

				$('#messages').append($('<li>').text(msg + " has connected"));
  			});

		</script>
	</body>

</html>
